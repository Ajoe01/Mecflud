
{% extends 'base.html' %}
{% block content %}

<div class="result-summary">
  <h2>Resultados personales</h2>
  {% if detalle and detalle|length > 0 %}
    <p>Puntaje: <b>{{ puntaje }}/{{ total }}</b></p>
    <table class="res-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Tu respuesta</th>
          <th>Correcta</th>
          <th>Estado</th>
          <th>Explicación</th>
        </tr>
      </thead>
      <tbody>
        {% for d in detalle %}
          <tr class="{{ 'ok' if d.ok else 'bad' }}">
            <td>{{ d.id }}</td>
            <td>{{ d.seleccion }}</td>
            <td>{{ d.correcta }}</td>
            <td>{{ '✅' if d.ok else '❌' }}</td>
            <td class="left">{{ d.exp }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="muted">Aún no has enviado este cuestionario.</p>
  {% endif %}
</div>

<div class="result-summary">
  <h2>Resultados globales (ordenado por correctas)</h2>
  <table class="res-table">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Usuario</th>
        <th>Correctas</th>
        <th>Total</th>
        <th>%</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody>
      {% for r in tabla %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ r.username }}</td>
          <td>{{ r.score }}</td>
          <td>{{ r.total }}</td>
          <td>{{ (100 * r.score / (r.total if r.total>0 else 1)) | round(1) }}%</td>
          <td>{{ r.fecha }}</td>
        </tr>
      {% endfor %}
      {% if not tabla or tabla|length == 0 %}
        <tr><td colspan="6">Aún no hay envíos.</td></tr>
      {% endif %}
    </tbody>
  </table>
</div>

{% endblock %}